<script>

  window.addEventListener('scroll', function () {
    if (this.window.scrollY > 500) {
      document.getElementById('botonSubir').style.transform = "scale(1)"
    }
    if (this.window.scrollY < 500) {
      document.getElementById('botonSubir').style.transform = "scale(0)"
    }
  })

  function subirArriba() {
    document.documentElement.scrollTop = 0
  }
  function limpiar() {
    eliminarTabla();
    eliminarTarjetas();
    crearLoaderPuntos('divContactos');
  }
  
  /* insertarContactos */
  function insertarContacto() {
    limpiar();
    let nombre = document.getElementById('nombre').value;
    let correo = document.getElementById('correo').value;
    let apellido = document.getElementById('apellidos').value;
    let telefono = document.getElementById('tel').value;

    bootstrap.Modal.getInstance(document.getElementById('crearContactoModal')).hide();

    google.script.run
      .withSuccessHandler(insertarContactoCorrecto)
      .withFailureHandler(insertarContactoError)
      .insertarContacto(nombre, apellido, correo, telefono);
  }
  function insertarContactoCorrecto() {
    document.getElementById('nombre').value = '';
    document.getElementById('correo').value = '';
    crearNotificacionContacto('Datos cargados correctamente', 'Exelente');
    eliminarLoader();
    crearTablaContactos();
  }
  function insertarContactoError() {
    crearNotificacionError('Ha habido un error en el ingreso de datos', 'Error');
    eliminarLoader();
    crearTablaContactos();
  }

  /*   function crearNotificacion(mensaje,titulo) {
      document.getElementById('mensajeNotificacion').textContent = mensaje;
      document.getElementById('tituloNotificacion').textContent = titulo;
      let elemetoNotificacion = document.getElementById('notificacion');
      bootstrap.Toast.getOrCreateInstance(elemetoNotificacion).show();
    } */
  /*   function crearNotificacionOk(mensaje,titulo) {
          crearNotificacion(mensaje,titulo);
          notificacionIconoOk();
          crearColorNotificacion('--color-verde-oscuro')
      }
    function crearNotificacionError(mensaje,titulo) {
          crearNotificacion(mensaje,titulo);
          notificacionIconoError();
          crearColorNotificacion('--color-rojo-oscuro')
      } */
  /*   function crearNotificacionAdvertencia(mensaje,titulo) {
          crearNotificacion(mensaje,titulo);
          notificacionIconoAdvertencia();
          crearColorNotificacion('--color-amarillo-oscuro')
      } */
  /*   function notificacionIconoOk() {
      iconoNotificacion.className='';
      iconoNotificacion.classList.add('bi','bi-check2-square');
    }
    function notificacionIconoError() {
      iconoNotificacion.className='';
      iconoNotificacion.classList.add('bi','bi-bug');
    }
    function notificacionIconoAdvertencia() {
      iconoNotificacion.className='';
      iconoNotificacion.classList.add('bi','bi-exclamation-square');
    } */
  /*   function crearColorNotificacion(color) {
      let elemetoNotificacion = document.getElementById('notificacion');
      elemetoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue(color);
    }  */

  /* borrar contactos */
  function borrarContactos(numFila) {
    limpiar();
    google.script.run
      .withSuccessHandler(borrarContactoCorrecto)
      .withFailureHandler(borrarContactoError)
      .eliminarContacto(numFila);
  }
  function borrarContactoCorrecto() {
    crearNotificacionBorrar('Contacto Eleminado correctamente', 'Exelente');
    eliminarLoader();
    crearTablaContactos();
  }
  function borrarContactoError() {
    crearNotificacionError('Ups No se pudo borrar', 'Error');
    eliminarLoader();
    crearTablaContactos();
  }

  /* modificar Contactos */
  function modificarContacto(numFila) {
    bootstrap.Modal.getOrCreateInstance(document.getElementById('crearContactoModal')).hide();
    let nombre = document.getElementById('nombre').value;
    let correo = document.getElementById('correo').value;
    let apellido = document.getElementById('apellidos').value;
    let telefono = document.getElementById('tel').value;
    limpiar();
    google.script.run
      .withSuccessHandler(ModificarContactoCorrecto)
      .withFailureHandler(ModificarContactoError)
      .modificarContacto(numFila, { nombre, apellido, telefono, correo });
  }
  function ModificarContactoCorrecto() {
    crearNotificacionContacto('Contacto editado correctamente', 'contacto Ok');
    eliminarLoader();
    crearTablaContactos();
  }
  function ModificarContactoError() {
    crearNotificacionError('No se han podido editar los contactos', 'ERROR');
    eliminarLoader();
    crearTablaContactos();
  }


</script>