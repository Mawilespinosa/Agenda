<script>

  function crearTablaContactos()
  {
      google.script.run
      .withSuccessHandler(crearTablaContactosCorrecta)
      .withFailureHandler(crearTablaContactosError)
      .obtenerContactos();
  }

  function crearTablaContactosCorrecta(obj) {
                  
    let tabla = document.getElementById('tablaContactos');
        if(tabla) tabla.remove();
        tabla = document.createElement('table');
        tabla.id = 'tablaContactos';

        let tablaHeader = document.createElement('thead');
        let tablaBody = document.createElement('tbody');

        for (let i = 0;i < obj.length;i++) {
            let fila = document.createElement('tr');
            for (let j = 0;j < obj[i].length;j++) {
                console.log(obj[i][j]);
                let celda = document.createElement('td');
                celda.textContent = obj[i][j];
                fila.appendChild(celda);

                if(i==0)
                {
                    tablaHeader.appendChild(fila);
                    tabla.appendChild(tablaHeader);
                }
                else
                {
                    tablaBody.appendChild(fila);
                }
            }
            
        }
        tablaHeader.classList.add('table-dark');
        tabla.appendChild(tablaBody);
        tabla.classList.add('table','table-striped','border','border-4','border-dark');
        document.getElementById('divContactos').appendChild(tabla);
        
        crearNotificacionOk('Contacto obtenidos correctamente','Todo en orden');
  }

  function crearTablaContactosError() {
    crearNotificacionError('No se han podido leer los contactos','ERROR')
  }

  function crearNotificacion(mensaje,titulo) {
    document.getElementById('mensajeNotificacion').textContent = mensaje;
    document.getElementById('tituloNotificacion').textContent = titulo;
    let elemetoNotificacion = document.getElementById('notificacion');
    bootstrap.Toast.getOrCreateInstance(elemetoNotificacion).show();
  }

    function crearNotificacionOk(mensaje,titulo) {
        crearNotificacion(mensaje,titulo);
        notificacionIconoOk();
        crearColorNotificacion('--color-verde-oscuro')
    }
    function crearNotificacionError(mensaje,titulo) {
        crearNotificacion(mensaje,titulo);
        notificacionIconoError();
        crearColorNotificacion('--color-rojo-oscuro')
    }
    function crearNotificacionAdvertencia(mensaje,titulo) {
        crearNotificacion(mensaje,titulo);
        notificacionIconoAdvertencia();
        crearColorNotificacion('--color-amarillo-oscuro')
    }

  function notificacionIconoOk() {
    iconoNotificacion.className='';
    iconoNotificacion.classList.add('bi','bi-check2-square');
  }
  function notificacionIconoError() {
    iconoNotificacion.className='';
    iconoNotificacion.classList.add('bi','bi-bug');
  }
  function notificacionIconoAdvertencia() {
    iconoNotificacion.className='';
    iconoNotificacion.classList.add('bi','bi-exclamation-square');
  }
  function crearColorNotificacion(color) {
    let elemetoNotificacion = document.getElementById('notificacion');
    elemetoNotificacion.style.backgroundColor = getComputedStyle(document.documentElement).getPropertyValue(color);
  } 

    </script>